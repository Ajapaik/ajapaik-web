{% load thumbnail %}

<div class="photos clearfix">
	<div class="original">

        {% thumbnail photo.image "700x400" as im %}
		<img src="{{ im.url }}" />
        {% endthumbnail %}

		<div class="tools">
			<div class="description">
				{{ photo.description }}
				<p class="owner">Pilt on pärit Eesti Ajaloomuuseumi fotokogust.</p>
			</div>
		</div>
	
	</div>
	<div class="rephoto">

		<!-- <a href="#" class="info">Info</a> -->

		<img src="http://www.ajapaik.ee/media/cache/90/2a/902a310a4f1b6b21a72641a0d816fb9f.jpg" />

		<div class="tools">

			<ul class="thumbs">

				<li class="add-rephoto"><a href="#" class="btn small">Lisa ülepildistus</a></li>

            {% for rephoto in photo.rephotos.all %}

				<li class="photo"><a href="#" rel="{% thumbnail rephoto.image "700x400" as image %}{{ image.url }}{% endthumbnail %}"><img src="{% thumbnail rephoto.image "40x40" as thumb %}{{ thumb.url }}{% endthumbnail %}" /></a></li>

            {% endfor %}
			</ul>
		</div>

	</div>
</div>





<div id="notice-container" style="display: none">

<div id="notice">

    <script src="{{ MEDIA_URL }}js/jquery.html5_upload.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function() {
            $("#upload_field").html5_upload({
                url: function(number) {
                    return '{% url views.photo_upload photo.pk %}';
                    //return prompt(number + " url", "/");
                },
                sendBoundary: window.FormData || $.browser.mozilla,
                onStart: function(event, total) {
                    return confirm("You are trying to upload " + total + " files. Are you sure?");
                },
                setName: function(text) {
                    $("#progress_report_name").text(text);
                },
                setStatus: function(text) {
                    $("#progress_report_status").text(text);
                },
                setProgress: function(val) {
                    $("#progress_report_bar").css('width', Math.ceil(val*100)+"%");
                },
                onFinishOne: function(event, response, name, number, total) {
                    //alert(response);
                }
            });
        });
    </script>

	<a href="#" id="upload" class="btn green" onclick="$('#upload_field').trigger('click'); return false;">Vali pildifail</a>

	<input type="file" multiple="multiple" id="upload_field" style="display: none;" />
    <div id="progress_report">
            <div id="progress_report_name"></div>
            <div id="progress_report_status" style="font-style: italic;"></div>
            <div id="progress_report_bar_container" style="width: 90%; height: 5px;">
                    <div id="progress_report_bar" style="background-color: blue; width: 0; height: 100%;"></div>
            </div>
    </div>

</div>

</div>


</div>
