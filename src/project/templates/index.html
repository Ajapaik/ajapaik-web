{% extends 'layouts/game.html' %}
{% load thumbnail i18n %}

{% block content %}
<script type="text/javascript">
	var saveLocationURL = '{% url views.geotag_add %}';
	var leaderboardUpdateURL = '{% url views.leaderboard %}';
	var leaderboardFullURL = '{% url views.top50 %}';
	var city_id = '{{ city.id }}';
	var start_location = [{{ city.lon }}, {{ city.lat }}];
	
</script>

<div id="game">

	<div id="top">
		<div class="score_container">

			<h2><a id="full_leaderboard" href="#">{% trans "Leaderboard" %}</a></h2>

			<ul class="scoreboard">
			</ul>

			{% if request.user.is_authenticated and request.user.get_profile.fb_id %}
				{% with profile=request.user.get_profile user=request.user %}
				<div id="facebook-connected">
					<p>{% blocktrans with "<a href='/logout'>" as link_open and "</a>" as link_close and user.get_full_name as account_name %}Account ({{ account_name }}) connected with Facebook. If it's not you then {{ link_open }}click here{{ link_close }}.{% endblocktrans %}</p>
				</div>
				{% endwith %}
			{% else %}
				<div id="facebook-connect">
					<p>{% trans "Facebook Connect to save your score and continue later." %}</p>
					<a href="/facebook/login" class="ir">{% trans "Connect with Facebook" %}</a>
				</div>
			{% endif %}

		</div>
	</div>

	<div id="tools">
		<a id="save-location" href="#" class="btn green">{% trans "Save location" %}</a>
		<a id="close-location-tools" href="#" class="btn medium">{% trans "Close map" %}</a>
        <div id="map_canvas" style="width:100%; height:100%"></div>
	</div>

	<div id="photos">
	</div>
	<a id="skip-photo" href="#" class="skip-photo">{% trans "Next photo" %} &rarr;</a>

	<a id="back-home" href="/?city={{city.id}}">&larr; {% trans "Back to home page" %}</a>

	<div id="btm">
		<div id="open-location-tools-container">
			<a id="open-location-tools" href="#" class="btn green">{% trans "Pick the shooting location!" %}</a>
		</div>
	</div>

	<div id="notice" style="display: none;">
		<h2>{% trans "Thank you!" %}</h2>
		<p class="message"></p>
		<a id="continue-game" href="" class="btn small">{% trans "Next photo" %}</a>
	</div>
	
	<div style="display: none;">
		<div id="leaderboard_browser">
		<div class="single">
			<a style="position:absolute;right:10px;" href="javascript:void(0);" onclick="$.modal.close();">{% trans "Close" %}</a>
			<div class="score_container">
				<ul class="scoreboard" style="max-height:300px;overflow-y:auto;padding-right:10px;"></ul>
			</div>
		</div>
	</div>

</div>

{% endblock %}
