from django.core.management.base import BaseCommand                                                                                                                                                                                                                       
from django.shortcuts import get_object_or_404
from ajapaik import settings
from ajapaik.ajapaik.models import Album, AlbumPhoto, Photo
import os

class Command(BaseCommand):
    help = 'Add photo objects for postcard backs in DIGAR'
    def handle(self, *args, **options):
        ids = [69476,68656,70669,70364,55886,67977,55832,70030,69933,55854,69490,71231,56983,70795,69756,70627,69283,69122,70242,70500,70319,69587,70230,70518,69277,70633,66504,69583,56328,70243,70531,68677,69181,70250,69485,71005,69238,68655,70407,70833,69939,57476,66343,69473,69089,70004,69457,69599,69728,69576,71040,69820,65606,70610,68728,70080,69615,67858,70261,69737,70819,69253,68999,69819,70396,69582,56287,69506,70993,70851,68628,68897,71185,70421,70405,67681,67469,70668,71079,69723,68664,69594,69869,69006,68652,70649,69746,70249,69784,70930,69925,67797,70639,68864,68997,65725,69545,69138,69899,69495,70225,68658,69593,69697,63920,69492,70363,69524,71121,69450,71020,71661,71133,69696,69570,71140,69474,69563,70146,69729,55824,69591,70077,69467,55846,65812,69126,69572,68663,64396,68635,69003,70403,66795,70593,69608,69571,68902,68764,69447,68580,70257,67798,69555,68925,68908,70368,68629,69391,70677,68644,68668,69703,69236,68900,67838,67085,70232,66527,71135,69900,68988,70823,70226,69511,70622,66350,70128,68581,55880,70070,70133,69155,69926,69528,71050,70415,69493,69376,57485,69396,68578,69456,69785,71019,71015,71002,68577,70367,70646,70943,69144,69997,70673,70853,64385,69383,55845,69123,70926,69393,69566,70236,69262,69251,69721,68661,70370,70248,58525,56978,55844,68916,64110,70488,69007,67084,70589,66341,69380,67091,70992,69769,69897,57509,70585,70237,70534,67566,70664,69177,57477,69243,69085,69197,69865,68976,70361,69223,69462,69489,70145,69487,66338,55850,69470,69186,68804,69017,71068,68645,69488,69564,69237,68758,69585,69603,56368,69278,64002,70573,71095,67716,69152,55834,69075,69699,70228,69448,69738,69514,71000,69574,70116,68765,70318,69190,70235,65441,69196,69931,68959,70240,68022,67276,69460,66773,69562,69472,70659,69372,70173,71103,66798,55847,68542,69449,69180,68730,67452,71099,58475,69573,71110,68842,68741,70436,69228,67827,55816,66805,69161,69170,69568,70560,69884,55829,71106,69552,69901,68674,67223,68763,70552,70263,68924,55817,68803,55858,68853,69173,70028,69565,71100,69022,69597,70588,70359,55840,70360,71065,69082,69567,70662,70638,68992,69913,55842,69005,66801,69390,68977,70175,69018,55849,69134,69260,71001,70065,69377,56602,70413,70234,56601,71091,70082,71223,55839,68672,70667,70260,69553,71132,69192,66339,70496,71094,69392,70658,68660,70591,69546,68675,70092,71134,71102,70282,69749,71017,66358,70489,68625,66356,70850,56605,69962,66800,69702,67476,69918,68653,69822,70676,69937,68904,70358,69522,63997,70217,68798,66337,69362,69385,70366,70498,69107,69575,71373,69547,71108,58524,55826,69023,69559,70292,71051,69452,69549,64001,69011,67793,70592,69706,69159,70241,70357,69590,56366,71069,67475,70160,69276,69735,69898,71105,69542,69755,55830,69187,69874,69479,,70112,71011,66809,69707,64386,70076,69605,70554,69814,70084,69198,69787,70657,56367,66340,70074,67657,68572,58495,55855,70083,66799,69143,70928,70815,68989,70515,55828,70651,69009,70996,70161,69451,69486,68666,70989,70423,69179,69561,71114,70447,68570,57479,70797,69453,70576,69203,69554,71230,71229,68785,68901,70645,69922,68662,70163,69859,69174,69471,69247,70852,68910,67629,68591,68583,65604,69698,69175,69886,68657,57432,69609,71186,71056,69494,57620,69914,70317,69199,69012,69743,71660,69229,69529,70422,68576,69483,66359,68896,69525,69188,69896,56275,69469,56298,70017,70513,70666,66797,71187,70615,69577,69160,69584,70854,70426,69613,71109,69178,63996,69772,70528,55838,70707,70356,69043,58493,69063,68746,69727,67272,58523,71028,70008,70644,69823,69942,69386,69125,68802,71228,66522,70412,70696,69207,71066,68995,70220,71368,70416,70647,69499,69595,71101,69975,68573,68698,58693,55841,58517,69008,70457,69851,69915,68759,70085,70643,71009,56369,69284,69073,70636,55843,71122,69929,69534,69226,70998,70245,70745,63919,70379,69015,70238,55857,70577,58481,71080,71120,68654,71206,70670,70227,70834,65782,69600,69520,68937,69560,67470,69221,69210,70164,70414,69222,69032,55827,66348,69382,69903,69532,69234,70525,70661,71369,71024,71097,68905,70969,69578,68745,68696,70671,68800,69581,66803,70247,66352,69705,70137,69371,68987,69389,69049,69604,69961,69388,69458,68899,68996,68693,69224,71021,65771,71107,69761,69607,68665,69127,70587,68744,70144,69776,67376,69700,68931,69895,67714,70991,70648,67262,58532,69872,69475,68673,70111,71111,55852,56606,69491,66357,69378,69325,70176,70490,70424,69482,68575,69941,70832,69602,66345,71035,70870,67261,69747,64397,56297,69261,69481,69280,69513,69164,69397,68747,68801,55815,69579,69370,67796,67472,68906,67867,68903,69010,69239,71023,70575,70641,70369,66796,69279,71010,69227,69004,68949,56276,68667,66793,69586,69480,67474,70362,70841,71209,69381,69904,70660,55833,69212,71070,70425,65545,56303,69916,65735,70223,66794,69550,71138,70239,69163,69569,63998,69927,70734,69860,69477,64000,68582,70035,69740,69205,68749,68721,69725,70087,57109,68017,69940,70246,70586,54789,71663,54784,68907,70244,68676,70634,68467,70873,69558,70006,64395,69446,67089,70123,70233,69722,71026,69256,55835,69478,69598,68695,68457,69527,69394,55856,58472,55853,71662,69882,69523,69917,70631,57478,69084,68678,69255,69374,69526,66594,68697,68541,69551,69701,71198,69902,68679,71049,70751,70088,70796,69906,69208,66363,69556,68929,69136,68659,68748,69704,69124,70224,69588,69001,71131,70259,66806,69195,66804,69919,55831,69932,69484,70428,69225,57162,70068,70150,57111,66802,69263,70635,70023,69531,70929,65693,69281,55887,68669,71224,67289,69468,69259,68636,68700,58407,70091,68755,69589,68466,70005,69541,68978,69864,69732,69455,71025,71112,71027,69235,70024,58396,69928,70365,71098,68571,69538,71022,69016,69379,69930,69515,71104,71264,69530,71039,65605,69206,70650,69512,70429,56600,71092,70555,70672,67720,69893,69536,68709,70355,69031,67715,68671]
        photos = os.listdir(settings.MEDIA_ROOT + "/uploads/Digar_postkaartide_tagakyljed/")
        for p in photos:
            if not p.split("_")[1] in ids:
                photos2 = Photo.objects.filter(image="/home/ajapaik/ajapaik-web/media/uploads/Digar_postkaartide_tagakyljed/DIGAR_" + p.split("_")[1] + "_2.jpg")
                if photos2:
                    for photo2 in photos2:
                        print(photo2.id)
                        os.rename(settings.MEDIA_ROOT + "/uploads/Digar_postkaartide_tagakyljed/" + "DIGAR_" + p.split("_")[1] + "_2.jpg", settings.MEDIA_ROOT + "/uploads/" + "DIGAR_" + p.split("_")[1] + "_2.jpg")
                        photo2.image = "/home/ajapaik/ajapaik-web/media/uploads/DIGAR_" + p.split("_")[1] + "_2.jpg"