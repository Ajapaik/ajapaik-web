!function(e){"use strict";"function"==typeof define&&define.amd?define(["load-image","load-image-meta"],e):e(window.loadImage)}(function(x){"use strict";x.ExifMap=function(){return this},x.ExifMap.prototype.map={Orientation:274},x.ExifMap.prototype.get=function(e){return this[e]||this[this.map[e]]},x.getExifThumbnail=function(e,i,t){var n,a,f;if(t&&!(i+t>e.byteLength)){for(n=[],a=0;a<t;a+=1)f=e.getUint8(i+a),n.push((f<16?"0":"")+f.toString(16));return"data:image/jpeg,%"+n.join("%")}console.log("Invalid Exif data: Invalid thumbnail data.")},x.exifTagTypes={1:{getValue:function(e,i){return e.getUint8(i)},size:1},2:{getValue:function(e,i){return String.fromCharCode(e.getUint8(i))},size:1,ascii:!0},3:{getValue:function(e,i,t){return e.getUint16(i,t)},size:2},4:{getValue:function(e,i,t){return e.getUint32(i,t)},size:4},5:{getValue:function(e,i,t){return e.getUint32(i,t)/e.getUint32(i+4,t)},size:8},9:{getValue:function(e,i,t){return e.getInt32(i,t)},size:4},10:{getValue:function(e,i,t){return e.getInt32(i,t)/e.getInt32(i+4,t)},size:8}},x.exifTagTypes[7]=x.exifTagTypes[1],x.getExifValue=function(e,i,t,n,a,f){var g,s,r,o,l,u,d=x.exifTagTypes[n];if(d){if(!((s=4<(g=d.size*a)?i+e.getUint32(t+8,f):t+8)+g>e.byteLength)){if(1===a)return d.getValue(e,s,f);for(r=[],o=0;o<a;o+=1)r[o]=d.getValue(e,s+o*d.size,f);if(d.ascii){for(l="",o=0;o<r.length&&"\0"!==(u=r[o]);o+=1)l+=u;return l}return r}console.log("Invalid Exif data: Invalid data offset.")}else console.log("Invalid Exif data: Invalid tag type.")},x.parseExifTag=function(e,i,t,n,a){var f=e.getUint16(t,n);a.exif[f]=x.getExifValue(e,i,t,e.getUint16(t+2,n),e.getUint32(t+4,n),n)},x.parseExifTags=function(e,i,t,n,a){var f,g,s;if(t+6>e.byteLength)console.log("Invalid Exif data: Invalid directory offset.");else{if(!((g=t+2+12*(f=e.getUint16(t,n)))+4>e.byteLength)){for(s=0;s<f;s+=1)this.parseExifTag(e,i,t+2+12*s,n,a);return e.getUint32(g,n)}console.log("Invalid Exif data: Invalid directory size.")}},x.parseExifData=function(e,i,t,n,a){if(!a.disableExif){var f,g,s,r=i+10;if(1165519206===e.getUint32(i+4))if(r+8>e.byteLength)console.log("Invalid Exif data: Invalid segment size.");else if(0===e.getUint16(i+8)){switch(e.getUint16(r)){case 18761:f=!0;break;case 19789:f=!1;break;default:return void console.log("Invalid Exif data: Invalid byte alignment marker.")}42===e.getUint16(r+2,f)?(g=e.getUint32(r+4,f),n.exif=new x.ExifMap,(g=x.parseExifTags(e,r,r+g,f,n))&&!a.disableExifThumbnail&&(s={exif:{}},g=x.parseExifTags(e,r,r+g,f,s),s.exif[513]&&(n.exif.Thumbnail=x.getExifThumbnail(e,r+s.exif[513],s.exif[514]))),n.exif[34665]&&!a.disableExifSub&&x.parseExifTags(e,r,r+n.exif[34665],f,n),n.exif[34853]&&!a.disableExifGps&&x.parseExifTags(e,r,r+n.exif[34853],f,n)):console.log("Invalid Exif data: Missing TIFF marker.")}else console.log("Invalid Exif data: Missing byte alignment offset.")}},x.metaDataParsers.jpeg[65505].push(x.parseExifData)});